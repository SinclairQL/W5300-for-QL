         bsr      runtests
         rts
cmpic    moveq    #1,d0
         moveq    #2,d1
         move.w   (a2),d2
; Candidate name should be at least four characters long ('udp_') to have any chance of matching
         cmpi.w   #3,d2
         bls      cmpiexit
cmploop  move.b   0(a1,d1.w),d4
         cmp.b    2(a2,d1.w),d4
         beq      cmplend
         add.b    #$20,d4
         cmp.b    2(a2,d1.w),d4
         bne      cmpiexit
cmplend  dbf      d1,cmploop
         cmpi.b   #'_',6(a2,d1.w)
         bne      cmpiexit
         moveq    #0,d0
cmpiexit rts
isnum    moveq    #1,d0
         cmpi.b   #$30,d1
         blt      notnum
         cmpi.b   #$39,d1
         bgt      notnum
numok    moveq    #0,d0
notnum   rts
; Constants for testing
udpname  dc.w     'UDP'
udp2     dc.w     4,'udp_'
udp3     dc.w     4,'uDp_'
udp4     dc.w     4,'UDP_'
udp5     dc.w     4,'udpx'
udp6     dc.w     3,'udp'
foo      dc.w     3,'foo'
nul      dc.w     0
two      dc.w     2,'ab'
four     dc.w     4,'abcd'
udpplus  dc.w     7,'udpplus'
; Test code
runtests lea      udpname,a1
         lea      udp2,a2
         bsr      cmpic
         tst.b    d0
         bne      err
         lea      udp3,a2
         bsr      cmpic
         tst.b    d0
         bne      err
         lea      udp4,a2
         bsr      cmpic
         tst.b    d0
         bne      err
         lea      udp5,a2
         bsr      cmpic
         tst.b    d0
         beq      err
         lea      udp6,a2
         bsr      cmpic
         tst.b    d0
         beq      err
         lea      udpplus,a2
         bsr      cmpic
         tst.b    d0
         beq      err
         lea      foo,a2
         bsr      cmpic
         tst.b    d0
         beq      err
         lea      nul,a2
         bsr      cmpic
         tst.b    d0
         beq      err
         lea      two,a2
         bsr      cmpic
         tst.b    d0
         beq      err
         lea      four,a2
         bsr      cmpic
         tst.b    d0
         beq      err
         move.b   #'0',d1
         bsr      isnum
         tst.b    d0
         bne      err
         move.b   #'9',d1
         bsr      isnum
         tst.b    d0
         bne      err
         move.b   #'/',d1
         bsr      isnum
         tst.b    d0
         beq      err
         move.b   #':',d1
         bsr      isnum
         tst.b    d0
         beq      err
         move.b   #0,d1
         bsr      isnum
         tst.b    d0
         beq      err
         move.b   #255,d1
         bsr      isnum
         tst.b    d0
         beq      err
ok       moveq    #0,d0
         rts
err      moveq    #-1,d0
         rts
